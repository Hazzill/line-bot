<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gis form-Line</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css">
    <style>
        #optionsContainer1{
           width: 100%;
        }
        #optionsContainer2{
           width: 100%;
        }
        p {
          display: flex;
          flex-direction: column;
          align-items: center;
          width: 100%;
          border: 2px solid teal;
	  border-radius: 25px;
        }
        .p-2 {
        padding: 0.5rem!important;
        text-align: right;
}
        label {
          padding: 8px;
          font-size: 14px;
}
    </style>
</head>
<body class="bg-light">
    <form class="container" style="padding: 40px;">  
        <div class="row">
            <label class="col-3 p-2 col-form-label col-form-label-sm">ผู้แทนขาย</label>
            <input class="form-control col-4 m-2" name="SellerID" placeholder="" required>
	    </div>
	    <div class="row">
            <label class="col-3 p-2 col-form-label col-form-label-sm">เลขใบสั่งซื้อ</label>
            <input class="form-control col-4  m-2" name="ipo" value="-" placeholder="">
        </div>
        <div class="row">
            <label class="col-3 p-2 col-form-label col-form-label-sm">ลูกค้า</label>
            <input class="form-control col-8  m-2" name="customer" placeholder="" required>

            <label class="col-3 p-2 col-form-label col-form-label-sm">จังหวัด</label>
            <input class="form-control col-8 m-2" type="text" id="input1" onkeyup="showOptions('input1')" name="province" placeholder="เลือกจังหวัด..." required>
            <div id="optionsContainer1"></div>
	    </div>   
    <div class="row">     
	    <label class="col-3 p-2 col-form-label col-form-label-sm">รายการสินค้า</label>
        <input class="form-control col-8 m-2" type="text" id="input2" onkeyup="showOptions('input2')" name="product" placeholder="เลือกรายการสินค้า..." >
        <div id="optionsContainer2"></div>
	</div>
        <div class="row p2" style="">
            <label class="col-3 p-2 col-form-label col-form-label-sm">จำนวน</label>
            <input class="form-control col-2  m-2" type="number"  min="0" value="" step=".01" name="quantity" placeholder="" required>
            <label class="col-2 p-2 col-form-label col-form-label-sm">แถม</label>
            <input class="form-control col-2  m-2" type="number"  min="0" value="0" step=".01" name="gifs" placeholder="" >
            <label class="col-3 p-2 col-form-label col-form-label-sm">ราคา</label>
            <input class="form-control col-2  m-2" type="number" min="0" value="" step=".01" name="price" placeholder="" required>
            <label class="col-2 p-2 col-form-label col-form-label-sm">ส่วนลด</label>
            <input class="form-control col-2  m-2" type="number" min="0" value="0" step=".01"name="disc" placeholder="" >
        </div>
    </br>
        <div class="row p2">
            <label class="col-3 p-2 col-form-label col-form-label-sm">เครดิต/วัน</label>
            <select class="form-control col-4" name="credit" required>
                <option class="form-control " value="">เลือกเครดิต</option>
                <option class="form-control " value="เงินสด">เงินสด</option>
                <option class="form-control " value="7 วัน">7 วัน</option>
                <option class="form-control " value="30 วัน">30 วัน</option>
                <option class="form-control " value="60 วัน">60 วัน</option>  
                <option class="form-control " value="90 วัน">90 วัน</option>
              </select>
        </div>
    </br>
        <div class="row p2">
            <label class="col-3 p-2 col-form-label col-form-label-sm">หมายเหตุ</label>
            <textarea class="form-control col-8" name="note">-</textarea>
        </div>
        <div class="row" style="justify-content: center;">
        <input type="submit"  class=" col-6 mt-4 btn btn-success" value="บันทึกข้อมูล"  >
        </div>
    </form>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
	<script>
// ข้อมูลตัวเลือกของ input1
    var options1 = [
        'กระบี่','กรุงเทพมหานคร','กาญจนบุรี','กาฬสินธุ์','กำแพงเพชร','ขอนแก่น','จันทบุรี','ฉะเชิงเทรา','ชลบุรี','ชัยนาท','ชัยภูมิ','ชุมพร','เชียงราย','เชียงใหม่','ตรัง','ตราด','ตาก','นครนายก','นครปฐม','นครพนม','นครราชสีมา',
        'นครศรีธรรมราช','นครสวรรค์','นนทบุรี','นราธิวาส','น่าน','บึงกาฬ','บุรีรัมย์','ปทุมธานี','ประจวบคีรีขันธ์','ปราจีนบุรี','ปัตตานี','พระนครศรีอยุธยา','พะเยา','พังงา','พัทลุง','พิจิตร','พิษณุโลก','เพชรบุรี','เพชรบูรณ์',
        'แพร่','ภูเก็ต','มหาสารคาม','มุกดาหาร','แม่ฮ่องสอน','ยโสธร','ยะลา','ร้อยเอ็ด','ระนอง','ระยอง','ราชบุรี','ลพบุรี','ลำปาง','ลำพูน','เลย','ศรีสะเกษ','สกลนคร','สงขลา','สตูล','สมุทรปราการ','สมุทรสงคราม',
        'สมุทรสาคร','สระแก้ว','สระบุรี','สิงห์บุรี','สุโขทัย','สุพรรณบุรี','สุราษฎร์ธานี','สุรินทร์','หนองคาย','หนองบัวลำภู','อ่างทอง','อุดรธานี','อุตรดิตถ์','อุทัยธานี','อุบลราชธานี','อำนาจเจริญ'
         ];

// ข้อมูลตัวเลือกของ input2
    var options2 = [ 'AMCARDIA 5','AMCARDIA 10','DICLO SR 100','DOLONIL SR 100', 'ENACE 10','ENACE 5 (pck100)(10x10s)','ENACE 5(pck1000)(100x10s)','HEPARIN INJ','INRON SUCROSE INJ','METROGYL GEL','OFTOP 200','OMLEK 20','TENROL 50(50x10s)','TENROL 50(50x10'];

// ฟังก์ชันสำหรับแสดงตัวเลือก
    function showOptions(inputId) {
    var input = document.getElementById(inputId);
    var container = document.getElementById(`optionsContainer${inputId.slice(-1)}`);
    container.innerHTML = '';

    var inputValue = input.value.toLowerCase();
    var matchedOptions = [];

    if (inputId === 'input1') {
        matchedOptions = options1.filter(function(option) {
        return option.toLowerCase().indexOf(inputValue) > -1;
        });
    } else if (inputId === 'input2') {
        matchedOptions = options2.filter(function(option) {
        return option.toLowerCase().indexOf(inputValue) > -1;
        });
    }

    var limitedOptions = matchedOptions.slice(0, 3); // จำกัดตัวเลือกสูงสุดเป็น 3 รายการ

    limitedOptions.forEach(function(option) {
        var optionElement = document.createElement('p');
        optionElement.innerHTML = option;
        optionElement.addEventListener('click', function() {
        input.value = option;
        container.innerHTML = '';
        });
        container.appendChild(optionElement);
    });
}

        $(document).ready(function () {
            const liffId = "1660766925-qDv7zvV5";
            initializeLiff(liffId);
        })
        function initializeLiff(liffId) {
            liff.init({
                liffId: liffId
            }).then(() => {
                initializeApp();
            }).catch((err) => {
                console.log('LIFF Initialization failed ', err);
            });
        }
        function sendText(text) {
            liff.sendMessages([{
                'type': 'text',
                'text': text
            }]).then(function () {
                liff.closeWindow();
            }).catch(function (error) {
                window.alert('Failed to send message ' + error);
            });
        }
        const params = (new URL(document.location)).searchParams;
        const key = params.get('key');

        $(function () {
            $('form').submit(function () {
            const name     = $('input[name="SellerID"]').val();
            const ipo      = $('input[name="ipo"]').val();
            const customer = $('input[name="customer"]').val();
            const province = $('input[name="province"]').val();
            const product  = $('input[name="product"]').val();
            const quantity = $('input[name="quantity"]').val();
            const gifs     = $('input[name="gifs"]').val();
            const price    = $('input[name="price"]').val();
            const disc     = $('input[name="disc"]').val();
            const credit   = $('select[name="credit"]').val();
            const note     = $('textarea[name="note"]').val();
            const msg      = `${name}\n${ipo}\n${customer}\n${province}\n${product}\n${quantity}\n${gifs}\n${price}\n${disc}\n${credit}\n${note}`;

            // Check if the data is a duplicate before sending
            if (!localStorage.getItem(msg)) {
                localStorage.setItem(msg, true);
                sendText(msg);
            } else {
                alert('This data already exists.');
            }

            return false;
            });
        });

    </script> 
</body>
</html>
